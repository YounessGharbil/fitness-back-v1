"use strict";(self.webpackChunkfitness=self.webpackChunkfitness||[]).push([[92],{8953:(C,b,s)=>{s.d(b,{M:()=>M});var e=s(1135),t=s(8505),d=s(4854),m=s(8256),g=s(529);let M=(()=>{class r{constructor(n){this.http=n,this.baseURL=`${d._}/Package`,this.packagesSubject=new e.X([]),this.packages$=this.packagesSubject.asObservable()}loadPackages(){this.http.get(`${this.baseURL}`).subscribe({next:n=>{console.log(n),this.packagesSubject.next(n)},error:n=>{console.log(n)},complete:()=>{console.log("task complete")}})}updatePackages(n){this.packagesSubject.next(n)}createPackage(n){return this.http.post(`${this.baseURL}`,n).pipe((0,t.b)(_=>{const c=[...this.packagesSubject.value,_];this.updatePackages(c)}))}updatePackage(n){return this.http.put(`${this.baseURL}/${n.id}`,n)}deletePackage(n){return this.http.delete(`${this.baseURL}/${n}`).pipe((0,t.b)(()=>{const P=this.packagesSubject.value.filter(c=>c.id!==n);this.updatePackages(P)}))}getPackage(n){return this.http.get(`${this.baseURL}/${n}`)}getPackages(){return this.http.get(`${this.baseURL}`)}static#t=this.\u0275fac=function(_){return new(_||r)(m.LFG(g.eN))};static#e=this.\u0275prov=m.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})()},1005:(C,b,s)=>{s.d(b,{p:()=>t});var e=s(8256);let t=(()=>{class d{constructor(){this.tranches=[]}addTranche(g){this.tranches.push(g)}getTranches(){return this.tranches}setTranches(g){this.tranches=g}clearTranches(){this.tranches=[]}static#t=this.\u0275fac=function(M){return new(M||d)};static#e=this.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},2001:(C,b,s)=>{s.d(b,{K:()=>P});var e=s(8256),t=s(1005),d=s(805),m=s(6895),g=s(433),M=s(5593),r=s(4044),f=s(2688);function n(c,T){if(1&c){const a=e.EpF();e.TgZ(0,"div")(1,"div",3)(2,"div",4)(3,"div",5)(4,"span",6),e._UZ(5,"i",7),e.qZA(),e.TgZ(6,"p-calendar",8),e.NdJ("ngModelChange",function(o){const i=e.CHM(a).$implicit,l=e.oxw(2);return e.KtG(l.dueDates[i]=o)}),e.qZA()(),e.TgZ(7,"div",5)(8,"span",6),e._UZ(9,"i",9),e.qZA(),e.TgZ(10,"input",10),e.NdJ("ngModelChange",function(o){const i=e.CHM(a).$implicit,l=e.oxw(2);return e.KtG(l.amounts[i]=o)}),e.qZA()()()()()}if(2&c){const a=T.$implicit,u=e.oxw(2);e.xp6(6),e.MGl("name","dueDate",a,""),e.Q6J("appendTo","body")("ngModel",u.dueDates[a])("showIcon",!0),e.xp6(4),e.MGl("name","amount",a,""),e.Q6J("ngModel",u.amounts[a])}}function _(c,T){if(1&c){const a=e.EpF();e.ynx(0),e.YNc(1,n,11,6,"div",1),e.TgZ(2,"p-button",2),e.NdJ("click",function(o){e.CHM(a);const h=e.oxw();return e.KtG(h.confirm(o))}),e.qZA(),e.BQk()}if(2&c){const a=e.oxw();e.xp6(1),e.Q6J("ngForOf",a.getTranchesArray())}}let P=(()=>{class c{constructor(a,u,o){this.paymentTrancheService=a,this.confirmationService=u,this.messageService=o,this.amounts=[],this.dueDates=[],this.tranches=[],this.areTranchesSet=!1,this.eventEmitter=new e.vpe}ngOnInit(){this.calculatePriceAfterDiscount()}getTranchesArray(){return Array.from({length:this.numberOfTranches},(a,u)=>u)}setTranches(){const a=this.amounts.map((u,o)=>({amount:u,dueDate:this.formatDate(this.dueDates[o]),isTranchePaid:!1,paymentMode:null}));this.paymentTrancheService.setTranches(a),this.areTranchesSet=!0,this.eventEmitter.emit(this.areTranchesSet)}calculatePriceAfterDiscount(){this.priceAfterDiscount=this.packagePrice-this.discount/100*this.packagePrice}formatDate(a){return a?a.toISOString().split("T")[0]:""}confirm(a){this.confirmationService.confirm({target:a.target,message:"Are you sure that you want to proceed?",icon:"pi pi-exclamation-triangle",accept:()=>{this.setTranches(),this.messageService.add({severity:"info",summary:"Confirmed",detail:"You have accepted"})},reject:()=>{this.messageService.add({severity:"error",summary:"Rejected",detail:"You have rejected"})}})}static#t=this.\u0275fac=function(u){return new(u||c)(e.Y36(t.p),e.Y36(d.YP),e.Y36(d.ez))};static#e=this.\u0275cmp=e.Xpm({type:c,selectors:[["app-payment-tranche"]],inputs:{numberOfTranches:"numberOfTranches",discount:"discount",packagePrice:"packagePrice"},outputs:{eventEmitter:"eventEmitter"},decls:2,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],["icon","pi pi-check","label","Confirm",3,"click"],[1,"payment-tranche"],[1,"input-group-container"],[1,"p-inputgroup"],[1,"p-inputgroup-addon"],[1,"pi","pi-calendar"],["placeholder","Date d'\xe9ch\xe9ance",3,"appendTo","ngModel","name","showIcon","ngModelChange"],[1,"pi","pi-money-bill"],["pInputNumber","","placeholder","Montant",3,"ngModel","name","ngModelChange"]],template:function(u,o){1&u&&(e._UZ(0,"p-toast"),e.YNc(1,_,3,1,"ng-container",0)),2&u&&(e.xp6(1),e.Q6J("ngIf",o.numberOfTranches<10))},dependencies:[m.sg,m.O5,g.Fj,g.JJ,g.On,M.zx,r.FN,f.f],styles:[".payment-tranche[_ngcontent-%COMP%]   .input-group-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}.payment-tranche[_ngcontent-%COMP%]   .input-group-container[_ngcontent-%COMP%]   .p-inputgroup[_ngcontent-%COMP%]{margin-right:10px;width:calc(100% - 5px)}.payment-tranche[_ngcontent-%COMP%]   .input-group-container[_ngcontent-%COMP%]   .p-inputgroup[_ngcontent-%COMP%]:last-child{margin-right:0}"]})}return c})()},6091:(C,b,s)=>{s.d(b,{F:()=>M});var e=s(1135),t=s(8505),d=s(4854),m=s(8256),g=s(529);let M=(()=>{class r{constructor(n){this.http=n,this.baseURL=`${d._}/Subscription`,this.subscriptionsSubject=new e.X([]),this.subscriptions$=this.subscriptionsSubject.asObservable()}loadSubscriptions(){this.http.get(`${this.baseURL}`).subscribe({next:n=>{console.log("subbs loaded succesfuly //////////"),this.subscriptionsSubject.next(n)},error:n=>{console.log(n)},complete:()=>{console.log("task complete")}})}updateSubscriptions(n){this.subscriptionsSubject.next(n)}createSubscription(n){return console.log(n),this.http.post(`${this.baseURL}`,n).pipe((0,t.b)(_=>{const c=[...this.subscriptionsSubject.value,_];this.updateSubscriptions(c)}))}updateSubscription(n){return console.log(n.id),this.http.put(`${this.baseURL}/${n.id}`,n)}deleteSubscription(n){return this.http.delete(`${this.baseURL}/${n}`).pipe((0,t.b)(()=>{const P=this.subscriptionsSubject.value.filter(c=>c.id!==n);this.updateSubscriptions(P)}))}getSubscription(n){return this.http.get(`${this.baseURL}/${n}`)}getSubscriptions(){return this.http.get(`${this.baseURL}`)}static#t=this.\u0275fac=function(_){return new(_||r)(m.LFG(g.eN))};static#e=this.\u0275prov=m.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})()},4092:(C,b,s)=>{s.d(b,{a:()=>T});var e=s(805),t=s(8256),d=s(5849),m=s(6091),g=s(8953),M=s(1005),r=s(433),f=s(5593),n=s(9733),_=s(3608),P=s(7913),c=s(2001);let T=(()=>{class a{constructor(o,h,i,l,p,O,v){this.dialogConfig=o,this.subscriptionService=h,this.ref=i,this.messageService=l,this.confirmationService=p,this.packageService=O,this.paymentTrancheService=v,this.paymentMode={paymentTranches:null},this.isDiscountDisabled=!0,this.isPackageDisabled=!0,this.isStatusDisabled=!0,this.isNumberOfTranchesDisabled=!0}ngOnInit(){this.subscriptionToUpdate=this.dialogConfig.data.sub,this.packageService.loadPackages(),this.packagesSubscription=this.packageService.packages$.subscribe(o=>{this.allPackages=o})}ngOnDestroy(){this.updateSubSubscription&&this.updateSubSubscription.unsubscribe(),this.packagesSubscription&&this.packagesSubscription.unsubscribe()}updateSubscription(){const o={};null!=this.subscriptionToUpdate.discount&&!this.isDiscountDisabled&&(o.discount=this.subscriptionToUpdate.discount),null!=this.subscriptionToUpdate.status&&!this.isStatusDisabled&&(o.status=this.subscriptionToUpdate.status),null!=this.selectedPackage&&!this.isPackageDisabled&&(this.subscriptionToUpdate.subscribedPackage_id=this.selectedPackage.id,o.subscribedPackage_id=this.subscriptionToUpdate.subscribedPackage_id),null!=this.numberOfTranches&&!this.isNumberOfTranchesDisabled&&(this.paymentMode.paymentTranches=this.paymentTrancheService.getTranches(),o.paymentMode=this.paymentMode),o.id=this.subscriptionToUpdate.id,this.updateSubSubscription=this.subscriptionService.updateSubscription(o).subscribe({next:h=>{console.log(h)},error:h=>{console.log(h)},complete:()=>{console.log("task complete")}}),this.ref.close(this.subscriptionToUpdate)}confirmUpdate(){this.confirmationService.confirm({message:"\xcates-vous s\xfbr de vouloir continuer\xa0?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{this.messageService.add({severity:"info",summary:"Confirm\xe9",detail:"Vous avez accept\xe9"}),this.updateSubscription()},reject:o=>{switch(o){case e.wB.REJECT:this.messageService.add({severity:"error",summary:"Rejet\xe9",detail:"Vous avez rejet\xe9"});break;case e.wB.CANCEL:this.messageService.add({severity:"warn",summary:"Annul\xe9",detail:"Vous avez annul\xe9"})}}})}static#t=this.\u0275fac=function(h){return new(h||a)(t.Y36(d.S),t.Y36(m.F),t.Y36(d.E7),t.Y36(e.ez),t.Y36(e.YP),t.Y36(g.M),t.Y36(M.p))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-update-subscription"]],decls:24,vars:16,consts:[[1,"card"],[1,"p-fluid",2,"width","80%"],["pTooltip","S\xe9lectionnez le forfait","name","selectedPackage","optionLabel","packageName",3,"disabled","options","ngModel","ngModelChange"],["name","isPackageDisabled",3,"ngModel","ngModelChange"],[1,"input-group"],["pInputNumber","","pTooltip","Entrez la remise","name","discount","placeholder","Discount",2,"width","25%",3,"disabled","ngModel","ngModelChange"],["name","isDiscountDisabled",3,"ngModel","ngModelChange"],[1,"p-inputgroup"],[1,"p-radio"],["type","radio","id","active","name","status","value","active",3,"disabled","ngModel","ngModelChange"],["for","active"],["type","radio","id","blocked","name","status","value","blocked",3,"disabled","ngModel","ngModelChange"],["for","blocked"],["name","isStatusDisabled",3,"ngModel","ngModelChange"],["pInputNumber","","pTooltip","Saisissez le nombre de tranches","name","numberOfTranches","placeholder","Saisissez le nombre de tranches",2,"width","25%",3,"disabled","ngModel","ngModelChange"],["name","isNumberOfTranchesDisabled",3,"ngModel","ngModelChange"],[3,"numberOfTranches"],["pButton","","type","button","label","Sauvegarder",3,"click"]],template:function(h,i){1&h&&(t.TgZ(0,"div",0)(1,"form")(2,"div")(3,"span",1)(4,"p-dropdown",2),t.NdJ("ngModelChange",function(p){return i.selectedPackage=p}),t.qZA()(),t.TgZ(5,"p-inputSwitch",3),t.NdJ("ngModelChange",function(p){return i.isPackageDisabled=p}),t.qZA()(),t.TgZ(6,"div",4)(7,"input",5),t.NdJ("ngModelChange",function(p){return i.subscriptionToUpdate.discount=p}),t.qZA(),t.TgZ(8,"p-inputSwitch",6),t.NdJ("ngModelChange",function(p){return i.isDiscountDisabled=p}),t.qZA()(),t.TgZ(9,"div",7)(10,"div",8)(11,"input",9),t.NdJ("ngModelChange",function(p){return i.subscriptionToUpdate.status=p}),t.qZA(),t.TgZ(12,"label",10),t._uU(13,"ACTIVE"),t.qZA()(),t.TgZ(14,"div",8)(15,"input",11),t.NdJ("ngModelChange",function(p){return i.subscriptionToUpdate.status=p}),t.qZA(),t.TgZ(16,"label",12),t._uU(17,"BLOCKED"),t.qZA()(),t.TgZ(18,"p-inputSwitch",13),t.NdJ("ngModelChange",function(p){return i.isStatusDisabled=p}),t.qZA()(),t.TgZ(19,"div",4)(20,"input",14),t.NdJ("ngModelChange",function(p){return i.numberOfTranches=p}),t.qZA(),t.TgZ(21,"p-inputSwitch",15),t.NdJ("ngModelChange",function(p){return i.isNumberOfTranchesDisabled=p}),t.qZA()(),t._UZ(22,"app-payment-tranche",16),t.TgZ(23,"button",17),t.NdJ("click",function(){return i.confirmUpdate()}),t.qZA()()()),2&h&&(t.xp6(4),t.Q6J("disabled",i.isPackageDisabled)("options",i.allPackages)("ngModel",i.selectedPackage),t.xp6(1),t.Q6J("ngModel",i.isPackageDisabled),t.xp6(2),t.Q6J("disabled",i.isDiscountDisabled)("ngModel",i.subscriptionToUpdate.discount),t.xp6(1),t.Q6J("ngModel",i.isDiscountDisabled),t.xp6(3),t.Q6J("disabled",i.isStatusDisabled)("ngModel",i.subscriptionToUpdate.status),t.xp6(4),t.Q6J("disabled",i.isStatusDisabled)("ngModel",i.subscriptionToUpdate.status),t.xp6(3),t.Q6J("ngModel",i.isStatusDisabled),t.xp6(2),t.Q6J("disabled",i.isNumberOfTranchesDisabled)("ngModel",i.numberOfTranches),t.xp6(1),t.Q6J("ngModel",i.isNumberOfTranchesDisabled),t.xp6(1),t.Q6J("numberOfTranches",i.numberOfTranches))},dependencies:[r._Y,r.Fj,r._,r.JJ,r.JL,r.On,r.F,f.Hq,n.Lt,_.u,P.Ql,c.K],styles:[".card[_ngcontent-%COMP%]{padding:20px;border-radius:10px;box-shadow:0 4px 6px #0000001a}.card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .p-inputgroup[_ngcontent-%COMP%]{flex:1}.card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .p-radio[_ngcontent-%COMP%]{margin-right:20px}.card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .p-toggleButton[_ngcontent-%COMP%]{margin-top:10px;margin-left:auto}.card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:150px;align-self:flex-end;margin-top:20px}.input-group[_ngcontent-%COMP%]{margin-bottom:30px;margin-top:30px}.input-group[_ngcontent-%COMP%]   input[name=numberOfTranches][_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[name=discount][_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:5px;font-size:16px}"]})}return a})()}}]);