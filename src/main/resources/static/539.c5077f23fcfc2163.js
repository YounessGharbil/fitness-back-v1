"use strict";(self.webpackChunkfitness=self.webpackChunkfitness||[]).push([[539],{5539:(R,g,s)=>{s.r(g),s.d(g,{SubscriptionModule:()=>I});var u=s(6895),r=s(433),C=s(5009),f=s(5808),l=s(805),t=s(8256),m=s(6091),b=s(5849),_=s(799),M=s(8953),S=s(1005),d=s(5593),v=s(3631),P=s(9733),O=s(3608),x=s(2001);let T=(()=>{class o{constructor(e,n,i,a,c){this.subscriptionService=e,this.ref=n,this.contactService=i,this.packageService=a,this.paymentTrancheService=c,this.paymentMode={paymentTranches:null},this.newSubscription={subscribedContact_id:null,subscribedPackage_id:null,discount:null,paymentMode:{paymentTranches:[]}},this.saveDisabled=!0}ngOnInit(){this.contactService.loadContacts(),this.contactsSubscription=this.contactService.contacts$.subscribe(e=>{this.allContacts=e,this.contactSuggestions=this.allContacts.map(n=>`${n.nom} ${n.prenom}`)}),this.packageService.loadPackages(),this.packagesSubscription=this.packageService.packages$.subscribe(e=>{this.allPackages=e})}ngOnDestroy(){this.createSubSubscription&&this.createSubSubscription.unsubscribe(),this.packagesSubscription&&this.packagesSubscription.unsubscribe(),this.contactsSubscription&&this.contactsSubscription.unsubscribe()}addNewSubscription(){const e=this.allContacts.find(n=>`${n.nom} ${n.prenom}`===this.selectedContact);this.newSubscription.subscribedContact_id=e.id,this.newSubscription.subscribedPackage_id=this.selectedPackage.id,this.paymentMode.paymentTranches=this.paymentTrancheService.getTranches(),this.newSubscription.paymentMode=this.paymentMode,this.createSubSubscription=this.subscriptionService.createSubscription(this.newSubscription).subscribe({next:n=>{console.log(n),this.ref.close(this.newSubscription)},error:n=>{console.log(n)},complete:()=>{console.log("task complete")}})}searchContact(e){const n=e.query;this.contactSuggestions=this.allContacts.filter(i=>i.nom.toLowerCase().startsWith(n.toLowerCase())||i.prenom.toLowerCase().startsWith(n.toLowerCase())).map(i=>`${i.nom} ${i.prenom}`)}enableSaveSubscription(e){this.saveDisabled=!e}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(m.F),t.Y36(b.E7),t.Y36(_.y),t.Y36(M.M),t.Y36(S.p))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-subscription"]],decls:15,vars:10,consts:[[1,"card"],[1,"form-group"],[1,"input-group"],[1,"p-fluid"],["pTooltip","Saisissez le nom du contact","name","selectedContact","placeholder","Saisissez le nom du contact",3,"ngModel","suggestions","ngModelChange","completeMethod"],["pTooltip","S\xe9lectionnez le forfait","name","selectedPackage","optionLabel","packageName","placeholder","S\xe9lectionnez le forfait",3,"options","ngModel","ngModelChange"],["pInputNumber","","pTooltip","Entrez la remise","name","discount","placeholder","Entrez la remise",2,"width","50%",3,"ngModel","ngModelChange"],["pInputNumber","","pTooltip","Saisissez le nombre de tranches","name","numberOfTranches","placeholder","Saisissez le nombre de tranches",2,"width","50%",3,"ngModel","ngModelChange"],[3,"numberOfTranches","packagePrice","discount","eventEmitter"],["pButton","","type","button","label","Sauvegarder",3,"disabled","click"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"form")(2,"div",1)(3,"div",2)(4,"span",3)(5,"p-autoComplete",4),t.NdJ("ngModelChange",function(c){return i.selectedContact=c})("completeMethod",function(c){return i.searchContact(c)}),t.qZA()()(),t.TgZ(6,"div",2)(7,"span",3)(8,"p-dropdown",5),t.NdJ("ngModelChange",function(c){return i.selectedPackage=c}),t.qZA()()(),t.TgZ(9,"div",2)(10,"input",6),t.NdJ("ngModelChange",function(c){return i.newSubscription.discount=c}),t.qZA()(),t.TgZ(11,"div",2)(12,"input",7),t.NdJ("ngModelChange",function(c){return i.numberOfTranches=c}),t.qZA()(),t.TgZ(13,"app-payment-tranche",8),t.NdJ("eventEmitter",function(c){return i.enableSaveSubscription(c)}),t.qZA()(),t.TgZ(14,"button",9),t.NdJ("click",function(){return i.addNewSubscription()}),t.qZA()()()),2&n&&(t.xp6(5),t.Q6J("ngModel",i.selectedContact)("suggestions",i.contactSuggestions),t.xp6(3),t.Q6J("options",i.allPackages)("ngModel",i.selectedPackage),t.xp6(2),t.Q6J("ngModel",i.newSubscription.discount),t.xp6(2),t.Q6J("ngModel",i.numberOfTranches),t.xp6(1),t.Q6J("numberOfTranches",i.numberOfTranches)("packagePrice",null==i.selectedPackage?null:i.selectedPackage.price)("discount",i.newSubscription.discount),t.xp6(1),t.Q6J("disabled",i.saveDisabled))},dependencies:[r._Y,r.Fj,r.JJ,r.JL,r.On,r.F,d.Hq,v.Qc,P.Lt,O.u,x.K],styles:[".input-group[_ngcontent-%COMP%]{margin-bottom:15px}.input-group[_ngcontent-%COMP%]   input[name=discount][_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[name=numberOfTranches][_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:5px;font-size:16px}.input-group[_ngcontent-%COMP%]   input[name=discount][_ngcontent-%COMP%]:hover, .input-group[_ngcontent-%COMP%]   input[name=numberOfTranches][_ngcontent-%COMP%]:hover{border-color:#007bff}.card[_ngcontent-%COMP%]{max-width:100%;margin:0 auto;padding:20px;border:1px solid #ccc;box-shadow:0 0 20px #0000001a;height:100%}button[_ngcontent-%COMP%]{margin-top:1%;width:30%;background-color:#007bff;color:#fff;border:none;border-radius:5px;padding:.5rem;cursor:pointer}"]})}return o})();var y=s(4092),h=s(3009),Z=s(1740),w=s(2137),A=s(4044),k=s(6679);function N(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"div",8)(1,"span")(2,"input",9),t.NdJ("input",function(i){t.CHM(e);const a=t.oxw(),c=t.MAs(2);return t.KtG(c.filterGlobal(a.applyFilterGlobal(i),"contains"))}),t.qZA()(),t.TgZ(3,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(),a=t.MAs(2);return t.KtG(i.clear(a))}),t.qZA()()}}function F(o,p){1&o&&(t.TgZ(0,"tr")(1,"th",11)(2,"div",12),t._uU(3," Forfait abonn\xe9 "),t._UZ(4,"p-columnFilter",13),t.qZA()(),t.TgZ(5,"th",14)(6,"div",12),t._uU(7," Abonn\xe9 Contact "),t._UZ(8,"p-columnFilter",15),t.qZA()(),t.TgZ(9,"th",14)(10,"div",12),t._uU(11," Date de d\xe9but "),t._UZ(12,"p-columnFilter",16),t.qZA()(),t.TgZ(13,"th",14)(14,"div",12),t._uU(15," Date de fin "),t._UZ(16,"p-columnFilter",17),t.qZA()(),t.TgZ(17,"th",18)(18,"div",12),t._uU(19," Remise "),t._UZ(20,"p-columnFilter",19),t.qZA()(),t.TgZ(21,"th",14)(22,"div",12),t._uU(23," Prix apr\xe8s remise "),t._UZ(24,"p-columnFilter",20),t.qZA()(),t.TgZ(25,"th",18)(26,"div",12),t._uU(27," Statut "),t._UZ(28,"p-columnFilter",21),t.qZA()()())}function E(o,p){1&o&&(t.ynx(0),t._UZ(1,"p-tag",26),t.BQk())}function J(o,p){1&o&&t._UZ(0,"p-tag",27)}function U(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t.YNc(14,E,2,0,"ng-container",22),t.YNc(15,J,1,0,"ng-template",null,23,t.W1O),t.qZA(),t.TgZ(17,"td")(18,"button",24),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.updateSubscription(a))}),t.qZA()(),t.TgZ(19,"td")(20,"button",25),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.confirmDelete(a.id))}),t.qZA()()()}if(2&o){const e=p.$implicit,n=t.MAs(16);t.xp6(2),t.hij(" ",e.subscribedPackage.packageName," "),t.xp6(2),t.AsE(" ",e.subscribedContact.nom," ",e.subscribedContact.prenom," "),t.xp6(2),t.hij(" ",e.startDate," "),t.xp6(2),t.hij(" ",e.endDate," "),t.xp6(2),t.hij(" ",e.discount," "),t.xp6(2),t.hij(" ",e.priceAfterDiscount," "),t.xp6(2),t.Q6J("ngIf","active"===e.status)("ngIfElse",n)}}function z(o,p){1&o&&(t.TgZ(0,"tr")(1,"td",28),t._uU(2,"Aucun abonnement trouv\xe9."),t.qZA()())}function D(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"p-button",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.show())}),t.qZA()}}const Y=function(){return[5,10,20]},j=function(){return["status","subscribedContact.nom","subscribedContact.prenom","subscribedPackage.packageName"]},$=function(){return{"min-width":"80rem"}},Q=function(){return{width:"50vw"}},B=[{path:"",component:(()=>{class o{constructor(e,n,i,a){this.subscriptionService=e,this.dialogService=n,this.messageService=i,this.confirmationService=a,this.loading=!0}ngOnInit(){this.subscriptionService.loadSubscriptions(),this.subsSubscription=this.subscriptionService.subscriptions$.subscribe(e=>{this.subscriptions=e,this.loading=!1})}ngOnDestroy(){this.deleteSubSubscription&&this.deleteSubSubscription.unsubscribe(),this.subsSubscription&&this.subsSubscription.unsubscribe()}clear(e){e.clear()}applyFilterGlobal(e){return e.target.value}show(){this.ref=this.dialogService.open(T,{header:"Cr\xe9er un abonnement",width:"70vw",height:"50vw",modal:!0,contentStyle:{overflow:"auto"},maximizable:!0})}updateSubscription(e){console.log(e),this.ref=this.dialogService.open(y.a,{data:{sub:e},header:" Modifier un abonnement",width:"70vw",height:"50vw",modal:!0,contentStyle:{overflow:"auto"},maximizable:!0})}deleteSubscription(e){this.deleteSubSubscription=this.subscriptionService.deleteSubscription(e).subscribe({next:n=>{console.log(n)},error:n=>{console.log(n)},complete:()=>{console.log("task complete")}})}confirmDelete(e){this.confirmationService.confirm({message:"Voulez-vous supprimer cet enregistrement ?",header:"Confirmation de suppression",icon:"pi pi-info-circle",accept:()=>{this.deleteSubscription(e),this.messageService.add({severity:"info",summary:"Confirm\xe9",detail:"Enregistrement supprim\xe9"})},reject:n=>{switch(n){case l.wB.REJECT:this.messageService.add({severity:"error",summary:"Rejet\xe9",detail:"Vous avez rejet\xe9"});break;case l.wB.CANCEL:this.messageService.add({severity:"warn",summary:"Annul\xe9",detail:"Vous avez annul\xe9"})}}})}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(m.F),t.Y36(b.xA),t.Y36(l.ez),t.Y36(l.YP))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-subscription"]],decls:10,vars:15,consts:[[1,"card"],["dataKey","id","currentPageReportTemplate","Affichage du {first} au {last} des {totalRecords} entr\xe9es","columnResizeMode","expand","styleClass","p-datatable-gridlines",3,"value","rows","showCurrentPageReport","rowsPerPageOptions","loading","paginator","globalFilterFields","resizableColumns","tableStyle"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorleft"],[1,"flex"],["pInputText","","type","text","placeholder","Search keyword",3,"input"],["pButton","","label","Clear","icon","pi pi-filter-slash",1,"p-button-outlined",3,"click"],[2,"min-width","20rem"],[1,"flex","align-items-center"],["type","text","field","subscribedPackage","display","menu"],[2,"min-width","10rem"],["type","text","field","subscribedContact","display","menu"],["type","text","field","startDate","display","menu"],["type","text","field","endDate","display","menu"],[2,"min-width","7rem"],["type","numeric","field","discount","display","menu"],["type","numeric","field","priceAfterDiscount","display","menu"],["type","text","field","status","display","menu"],[4,"ngIf","ngIfElse"],["blockedTag",""],["pButton","","type","button","icon","pi pi-pencil",3,"click"],["pButton","","type","button","icon","pi pi-trash",3,"click"],["severity","success","value","Actif"],["severity","danger","value","bloqu\xe9e"],["colspan","7"],["type","button","icon","pi pi-plus","styleClass","p-button-text",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"p-table",1,2),t.YNc(3,N,4,0,"ng-template",3),t.YNc(4,F,29,0,"ng-template",4),t.YNc(5,U,21,9,"ng-template",5),t.YNc(6,z,3,0,"ng-template",6),t.YNc(7,D,1,0,"ng-template",7),t.qZA()(),t._UZ(8,"p-toast")(9,"p-confirmDialog")),2&n&&(t.xp6(1),t.Q6J("value",i.subscriptions)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(11,Y))("loading",i.loading)("paginator",!0)("globalFilterFields",t.DdM(12,j))("resizableColumns",!0)("tableStyle",t.DdM(13,$)),t.xp6(8),t.Akn(t.DdM(14,Q)))},dependencies:[u.O5,h.iA,l.jx,h.xl,d.Hq,d.zx,Z.o,w.Q,A.FN,k.V],styles:[".flex[_ngcontent-%COMP%]{display:flex;align-items:center}.flex[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:10px}.flex[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:12px;font-size:16px;border:1px solid #ddd;border-radius:5px;width:250px;box-shadow:0 0 5px #0000001a}.flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.card[_ngcontent-%COMP%]{margin:20px;padding:20px;border:1px solid #ddd;border-radius:8px;box-shadow:0 0 10px #0000001a;background-color:#fff}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]{width:100%;margin-top:20px}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   .p-datatable-header[_ngcontent-%COMP%]{background-color:#f2f2f2;border-bottom:1px solid #ddd}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   .p-datatable-header[_ngcontent-%COMP%]   .p-column-title[_ngcontent-%COMP%]{font-weight:700}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   .p-datatable-header[_ngcontent-%COMP%]   .p-paginator[_ngcontent-%COMP%]{margin-top:10px}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   .p-datatable-caption[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   .p-datatable-caption[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:10px}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   .p-datatable-caption[_ngcontent-%COMP%]   .p-input-icon-left[_ngcontent-%COMP%]{position:relative}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   .p-datatable-caption[_ngcontent-%COMP%]   .p-input-icon-left[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;transform:translateY(-50%)}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   .p-datatable-caption[_ngcontent-%COMP%]   .p-input-icon-left[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-right:30px}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:left;border:1px solid #ccc}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f2f2f2}.card[_ngcontent-%COMP%]   .p-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}"]})}return o})()}];let q=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[u.ez,f.Bz.forChild(B)]})}return o})(),I=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[u.ez,r.u5,C.g,q]})}return o})()}}]);